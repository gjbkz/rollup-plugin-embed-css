language: node_js
cache: npm
os: osx
node_js: '12'
addons:
  chrome: stable
install:
  - |
    if [[ $TRAVIS_OS_NAME = osx ]]; then
      export SUFFIX=mac64
    elif [[ $TRAVIS_OS_NAME = windows ]]; then
      choco install unzip
      export SUFFIX=win32
    else
      export SUFFIX=linux64
    fi
  - LATEST_RELEASE=$(curl https://chromedriver.storage.googleapis.com/LATEST_RELEASE)
  - wget https://chromedriver.storage.googleapis.com/${LATEST_RELEASE}/chromedriver_${SUFFIX}.zip
  - unzip chromedriver_${SUFFIX}.zip
script:
  - nvm install 12
  - npm ci
  - npm run build
  - npm install -g codecov c8
  - c8 npm run test
  - c8 report --reporter=text-lcov > coverage.lcov
  - codecov --disable=gcov
  - nvm install 10
  - npm install -g codecov c8
  - c8 npm run test
  - c8 report --reporter=text-lcov > coverage.lcov
  - codecov --disable=gcov
